---
title: 通过链接编译复杂的软件（二）—— 静态链接库、动态链接库和打桩
date: 2019-03-19 20:19:22
categories:
- 技术
tags:
- 计算机系统
- 编译
- 链接
- imhuwq
---

在分离编译和链接技术的帮助下，修改源代码后的重新构建工作不再那么耗时耗力。更重要的是，分离编译和链接这一个过程为我们提供了一套合作协议。  
在这套协议下，编译不仅可以是不同时的，甚至也可以是不同地的——我们可以编译修改后的源文件 A 再链接以前编译的模块 B，也可以编译自己电脑上的源文件 A 再链接其他开发者编译给我们的模块 B。这种特性非常适合使用第三库的场景，它使第三方库容易分发和使用(以及一定程度上的保密)。根据第三方库被链接的时期，发展出了静态链接库(编译时链接)和动态链接库(运行时链接)技术。  
此外，符号重定位这一步骤使得我们能够插手其中做一些干涉(interposition, 打桩)，比如把对库函数 A 的引用重定位到函数自己的函数 B ，在 B 里面做一些处理后再调用库函数 A，从而在无法/不需要修改库的情况下方便快速地实现定制功能。  
那静态链接库和动态链接库又是怎样的呢？  
和原本链接的 ELF 文件有什么差异呢？  
打桩技术又是怎样的呢？  

<!--more-->

## 一、静态链接库
通过链接而生成 ELF 文件的过程称为静态链接， 而静态链接库主要应用于静态链接过程中。  
静态链接库文件本身和可执行文件一样，也是通过编译和链接 ELF 文件得来的。当然，由于它不是被作为可执行文件，所以它比可执行文件要更简单一点(不需要 .init 节段头部表这些内容)。  
实际上，静态链接库甚至比上述的情况还要更简单：在生成静态链接库时甚至不需要重定位，只是把所有模块拼接在一起形成了一个存档(Archive)文件。  


## 二、动态链接库

## 三、打桩技术

## 四、总结
